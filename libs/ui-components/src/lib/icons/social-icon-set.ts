import { ChangeDetectionStrategy, Component, Input } from '@angular/core';
import { NgIf } from '@angular/common';

type IconName = 'twitter' | 'linkedin' | 'github' | 'discord';

const ICON_PATHS: Record<IconName, { path: string; viewBox?: string }> = {
  twitter: {
    path: 'M23.643 4.937a9.656 9.656 0 0 1-2.675.733 4.672 4.672 0 0 0 2.048-2.59 9.34 9.34 0 0 1-2.972 1.137 4.66 4.66 0 0 0-7.93 4.248A13.214 13.214 0 0 1 1.64 3.964a4.66 4.66 0 0 0 1.44 6.215 4.62 4.62 0 0 1-2.107-.582v.059a4.66 4.66 0 0 0 3.732 4.57 4.69 4.69 0 0 1-2.1.08 4.66 4.66 0 0 0 4.348 3.228A9.345 9.345 0 0 1 .965 19.1a13.19 13.19 0 0 0 7.156 2.1c8.588 0 13.29-7.112 13.29-13.29 0-.202-.004-.404-.013-.605a9.52 9.52 0 0 0 2.337-2.43Z',
  },
  linkedin: {
    path: 'M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.137 1.445-2.137 2.939v5.667H9.351V9h3.414v1.561h.049c.476-.9 1.637-1.852 3.37-1.852 3.601 0 4.268 2.37 4.268 5.455v6.288ZM5.337 7.433a2.062 2.062 0 1 1 0-4.124 2.062 2.062 0 0 1 0 4.124ZM6.813 20.452H3.56V9h3.253v11.452ZM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 22.977.792 24 1.771 24h20.451C23.2 24 24 22.977 24 22.271V1.729C24 .774 23.2 0 22.225 0Z',
  },
  github: {
    path: 'M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61-.546-1.387-1.333-1.758-1.333-1.758-1.089-.746.084-.731.084-.731 1.205.084 1.84 1.236 1.84 1.236 1.07 1.834 2.807 1.304 3.492.997.108-.776.417-1.305.76-1.605-2.665-.304-5.466-1.332-5.466-5.93 0-1.31.468-2.38 1.235-3.22-.135-.303-.54-1.527.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.649.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.922.42.36.81 1.096.81 2.22 0 1.604-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297 24 5.67 18.627.297 12 .297Z',
  },
  discord: {
    path: 'M20.318 4.37a19.76 19.76 0 0 0-4.885-1.515.08.08 0 0 0-.079.037c-.212.375-.445.865-.609 1.249-1.845-.276-3.68-.276-5.487 0-.164-.393-.406-.874-.618-1.249a.08.08 0 0 0-.048-.037A19.74 19.74 0 0 0 3.71 4.37a.07.07 0 0 0-.033.028C.533 9.046-.319 13.58.1 18.058a.08.08 0 0 0 .031.056c2.053 1.508 4.041 2.423 5.993 3.03a.08.08 0 0 0 .084-.028c.462-.63.873-1.295 1.226-1.994a.08.08 0 0 0-.038-.099 12.3 12.3 0 0 1-1.872-.893.08.08 0 0 1-.008-.128c.126-.094.252-.192.372-.291a.08.08 0 0 1 .068-.013c3.928 1.793 8.18 1.793 12.061 0a.08.08 0 0 1 .068.013c.12.099.246.198.373.291a.08.08 0 0 1-.007.128c-.598.353-1.22.645-1.872.893a.08.08 0 0 0-.038.099c.36.699.772 1.364 1.226 1.994a.08.08 0 0 0 .084.028c1.961-.607 3.95-1.522 6.002-3.03a.08.08 0 0 0 .032-.056c.5-5.177-.838-9.674-3.548-13.66a.07.07 0 0 0-.033-.028ZM8.02 15.33c-1.183 0-2.157-1.086-2.157-2.419 0-1.333.955-2.419 2.157-2.419 1.21 0 2.176 1.095 2.157 2.419 0 1.333-.956 2.419-2.157 2.419Zm7.975 0c-1.183 0-2.157-1.086-2.157-2.419 0-1.333.955-2.419 2.157-2.419 1.21 0 2.176 1.095 2.157 2.419 0 1.333-.946 2.419-2.157 2.419Z',
  },
};

@Component({
  selector: 'lib-social-icon-set',
  standalone: true,
  imports: [NgIf],
  templateUrl: './social-icon-set.html',
  styleUrl: './social-icon-set.css',
  changeDetection: ChangeDetectionStrategy.OnPush,
})
export class SocialIconSet {
  @Input({ required: true }) icon = '';

  protected get iconKey(): IconName | null {
    const key = this.icon?.toLowerCase().trim();
    return (['twitter', 'linkedin', 'github', 'discord'] as IconName[]).includes(key as IconName) ? (key as IconName) : null;
  }

  protected get iconPath(): { path: string; viewBox?: string } | null {
    const key = this.iconKey;
    return key ? ICON_PATHS[key] : null;
  }

  protected get fallback(): string {
    return this.icon?.charAt(0).toUpperCase() ?? '?';
  }
}
